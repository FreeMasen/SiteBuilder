<!DOCTYPE html>
<html>

<head>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            border: 0;
            background: #2c363f;
        }

        h1 {
            margin: 0;
            padding: 0;
        }

        * {
            font-family: 'SegoeUI', Tahoma, Geneva, Verdana, sans-serif;
            box-sizing: border-box;
        }

        #main {
            max-width: 800px;
            margin: 10px auto 0;
            background: #f2f5ea;
            padding: 10px;
        }

        #spinner-container {
            width: 100%;
            min-height: 400px;
            margin: 0;
            padding: 0;
            display: flex;
            flex-flow: row;
            justify-content: center;
            align-items: center;
        }

        #spinner {
            background: #2c363f;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            animation-duration: 1.5s;
            animation-name: spin;
            animation-iteration-count: infinite;
            display: flex;
            flex-flow: row;
            justify-content: space-between;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
            from {
                transform: rotate(0);
            }
        }

        .spinner-inner {
            width: 15px;
            height: 15px;
            margin: auto;
            background: #e75a7c;
            border-radius: 50%;
        }

        @keyframes fade-in {
            to {
                opacity: 100%;
            }
            from {
                opacity: 0;
            }
        }

        #app-container {
            animation-duration: 1s;
            animation-name: fade-in;
        }
/*
        #console {
            display: flex;
            flex-flow: column;
            justify-content: flex-start;
            align-content: flex-start;
            align-items: flex-start;
            min-height: 100px;
            width: 100%;
            background: blue;
        }

        .console-line {
            display: flex;
            flex-flow: row wrap;
            justify-content: flex-start;
            align-items: center;
            align-content: flex-start;
            border-bottom: 1px solid white;
            width: 100%;
            font-family: monospace;
            color: white;
        }

        .console-line-entry {
            display: block;
            margin-left: 5px;
        }

        .console-line.error {
            background: red;

        }

        .console-line.warn {
            background: rgb(189, 54, 5);
        }
*/
    </style>
</head>

<body>
    <div id="main">
        <div id="spinner-container">
            <div id="spinner">
                <div class="spinner-inner"></div>
                <div class="spinner-inner"></div>
            </div>
        </div>
    </div>
    <!-- <div id="console"></div> -->
    <script>
        window.addEventListener('DOMContentLoaded', function () {
            // setupCustomConsole();
            sendInit();
        })
        var initSent = false;
        function sendInit() {
            if (initSent) return;
            initSent = true;
            window.external.invoke(JSON.stringify({ kind: 'load' }));
        }
        function checkForLoaded() {
            var div = document.getElementById('main');
            if (!div) {
                return setTimeout(checkForLoaded, 0)
            }
            sendInit();
            // setupCustomConsole();
        }
        setTimeout(checkForLoaded, 5000);
        // function setupCustomConsole() {
        //     if (!console) {
        //         window.console = {
        //             log: log,
        //             error: error,
        //             warn: warn,
        //         }
        //     } else {
        //         console.log = log;
        //         console.error = error;
        //         console.warn = warn;
        //     }
        // }
        // function log() {
        //     var line = argsToDiv(arguments);
        //     print(line, 'console-line')
        // }
        // function error() {
        //     var line = argsToDiv(arguments);
        //     print(line, 'console-line error');
        // }
        // function warn() {
        //     var line = argsToDiv(arguments);
        //     print(line, 'console-line warn');
        // }
        // function argsToDiv(args) {
        //     var ret = document.createElement('div');
        //     ret.appendChild(argToSpan(timestamp()));
        //     for (var i = 0; i < args.length; i++) {
        //         ret.appendChild(argToSpan(args[i]))
        //     }
        //     return ret;
        // }
        // function timestamp() {
        //     var now = new Date();
        //     var m = now.getMonth() + 1;
        //     var d = now.getDate();
        //     var y = now.getFullYear().toString().substring(-2);
        //     var h = ('0' + now.getHours()).substring(-2);
        //     var min = ('0' + now.getMinutes()).substring(-2);
        //     var s = now.getSeconds();
        //     return m + '/' + d + '/' + y + ' ' + h + ':' + min + ':' + s + ': ';
        // }
        // function argToSpan(arg) {
        //     if (typeof arg != 'string') arg = JSON.stringify(arg)
        //     var ret = document.createElement('span');
        //     ret.setAttribute('console-line-entry');
        //     ret.appendChild(document.createTextNode(arg))
        //     return ret;
        // }
        // function print(element, className) {
        //     var div = document.getElementById('console');
        //     if (!div) return document.body.innerHTML = 'UNABLE TO FIND CONSOLE';
        //     element.setAttribute('class', className);
        //     div.appendChild(element);
        //     clearOld()
        // }
        // function clearOld() {
        //     var div = document.getElementById('console');
        //     if (!div) return;
        //     while (div.childElementCount > 12) {
        //         div.removeChild(div.firstChild);
        //     }
        // }
    </script>
    <script>
        // Polyfill for creating CustomEvents on IE9/10/11

        // code pulled from:
        // https://github.com/d4tocchini/customevent-polyfill
        // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent#Polyfill

        try {
            var ce = new window.CustomEvent('test');
            ce.preventDefault();
            if (ce.defaultPrevented !== true) {
                // IE has problems with .preventDefault() on custom events
                // http://stackoverflow.com/questions/23349191
                throw new Error('Could not prevent default');
            }
        } catch (e) {
            var CustomEvent = function (event, params) {
                var evt, origPrevent;
                params = params || {
                    bubbles: false,
                    cancelable: false,
                    detail: undefined
                };

                evt = document.createEvent("CustomEvent");
                evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);
                origPrevent = evt.preventDefault;
                evt.preventDefault = function () {
                    origPrevent.call(this);
                    try {
                        Object.defineProperty(this, 'defaultPrevented', {
                            get: function () {
                                return true;
                            }
                        });
                    } catch (e) {
                        this.defaultPrevented = true;
                    }
                };
                return evt;
            };

            CustomEvent.prototype = window.Event.prototype;
            window.CustomEvent = CustomEvent; // expose definition to window
        }
        // Production steps of ECMA-262, Edition 5, 15.4.4.19
        // Reference: http://es5.github.io/#x15.4.4.19
        if (!Array.prototype.map) {

            Array.prototype.map = function (callback/*, thisArg*/) {

                var T, A, k;

                if (this == null) {
                    throw new TypeError('this is null or not defined');
                }

                // 1. Let O be the result of calling ToObject passing the |this| 
                //    value as the argument.
                var O = Object(this);

                // 2. Let lenValue be the result of calling the Get internal 
                //    method of O with the argument "length".
                // 3. Let len be ToUint32(lenValue).
                var len = O.length >>> 0;

                // 4. If IsCallable(callback) is false, throw a TypeError exception.
                // See: http://es5.github.com/#x9.11
                if (typeof callback !== 'function') {
                    throw new TypeError(callback + ' is not a function');
                }

                // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
                if (arguments.length > 1) {
                    T = arguments[1];
                }

                // 6. Let A be a new array created as if by the expression new Array(len) 
                //    where Array is the standard built-in constructor with that name and 
                //    len is the value of len.
                A = new Array(len);

                // 7. Let k be 0
                k = 0;

                // 8. Repeat, while k < len
                while (k < len) {

                    var kValue, mappedValue;

                    // a. Let Pk be ToString(k).
                    //   This is implicit for LHS operands of the in operator
                    // b. Let kPresent be the result of calling the HasProperty internal 
                    //    method of O with argument Pk.
                    //   This step can be combined with c
                    // c. If kPresent is true, then
                    if (k in O) {

                        // i. Let kValue be the result of calling the Get internal 
                        //    method of O with argument Pk.
                        kValue = O[k];

                        // ii. Let mappedValue be the result of calling the Call internal 
                        //     method of callback with T as the this value and argument 
                        //     list containing kValue, k, and O.
                        mappedValue = callback.call(T, kValue, k, O);

                        // iii. Call the DefineOwnProperty internal method of A with arguments
                        // Pk, Property Descriptor
                        // { Value: mappedValue,
                        //   Writable: true,
                        //   Enumerable: true,
                        //   Configurable: true },
                        // and false.

                        // In browsers that support Object.defineProperty, use the following:
                        // Object.defineProperty(A, k, {
                        //   value: mappedValue,
                        //   writable: true,
                        //   enumerable: true,
                        //   configurable: true
                        // });

                        // For best browser support, use the following:
                        A[k] = mappedValue;
                    }
                    // d. Increase k by 1.
                    k++;
                }

                // 9. return A
                return A;
            };
        }
    </script>
</body>

</html>