<!DOCTYPEhtml>
<html>

<head>
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            border: 0;
            background: #2c363f;
        }

        h1 {
            margin: 0;
            padding: 0;
        }

        * {
            font-family: 'SegoeUI', Tahoma, Geneva, Verdana, sans-serif;
        }

        #main {
            max-width: 800px;
            margin: 10pxauto0;
            background: #f2f5ea;
            padding: 10px;
        }

        #spinner-container {
            width: 100%;
            min-height: 400px;
            margin: 0;
            padding: 0;
            display: flex;
            flex-flow: row;
            justify-content: center;
            align-items: center;
        }

        #spinner {
            background: #2c363f;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            animation-duration: 1.5s;
            animation-name: spin;
            animation-iteration-count: infinite;
            display: flex;
            flex-flow: row;
            justify-content: space-between;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
            from {
                transform: rotate(0);
            }
        }

        .spinner-inner {
            width: 15px;
            height: 15px;
            margin: auto;
            background: #e75a7c;
            border-radius: 50%;
        }

        @keyframes fade-in {
            to {
                opacity: 100%;
            }
            from {
                opacity: 0;
            }
        }

        #app-container {
            animation-duration: 1s;
            animation-name: fade-in;
        }

        #console {
            display: flex;
            flex-flow: column;
            justify-content: flex-start;
            align-content: flex-start;
            align-items: flex-start;
            min-height: 100px;
            width: 100%;
            background: blue;
        }
        .console-line {
            display: flex;
            flex-flow: row wrap;
            justify-content: flex-start;
            align-items: center;
            align-content: flex-start;
            border-bottom: 1px solid white;
            width: 100%;
            font-family: monospace;
            color: white;
        }

        .console-line-entry {
            display: block;
            margin-left: 5px;
        }

        .console-line.error {
            background: red;

        }
        .console-line.warn {
            background: rgb(189, 54, 5);
        }
    </style>
</head>

<body>
    <div id="main">
        <div id="spinner-container">
            <div id="spinner">
                <div class="spinner-inner"></div>
                <div class="spinner-inner"></div>
            </div>
        </div>
    </div>
    <div id="console"></div>
    <script>

        function checkForLoaded() {

            var div = document.getElementById('console');
            if (!div) {
                return setTimeout(checkForLoaded, 0)
            }
            window.external.invoke(JSON.stringify({kind: 'load'}));
            if (!console) {
                window.console = {
                    log: log,
                    error: error,
                    warn: warn,
                }
            } else {
                console.log = log;
                console.error = error;
                console.warn = warn;
            }
            console.log('testing logger');
        }
        checkForLoaded();
        function log() {
            var line = argsToDiv(arguments);
            print(line, 'console-line')
        }
        function error() {
            var line = argsToDiv(arguments);
            print(line, 'console-line error');
        }
        function warn() {
            var line = argsToDiv(arguments);
            print(line, 'console-line warn');
        }
        function argsToDiv(args) {
            var ret = document.createElement('div');
            ret.appendChild(argToSpan(timestamp()));
            for (var i = 0; i < args.length;i++) {
                ret.appendChild(argToSpan(args[i]))
            }
            return ret;
        }
        function timestamp() {
            var now = new Date();
            var m = now.getMonth() + 1;
            var d = now.getDate();
            var y = now.getFullYear().toString().substr(1);
            var h = now.getHours();
            var min = now.getMinutes();
            var s = now.getSeconds();
            return m + '/' + d + '/' + y + ' ' + h + ':' + min + ':' + s + ': ';
        }
        function argToSpan(arg) {
            if (typeof arg != 'string') arg = JSON.stringify(arg)
            var ret = document.createElement('span');
            ret.setAttribute('console-line-entry');
            ret.appendChild(document.createTextNode(arg))
            return ret;
        }
        function print(element, className) {
            var div = document.getElementById('console');
            if (!div) return document.body.innerHTML = 'UNABLE TO FIND CONSOLE';
            element.setAttribute('class', className);
            div.appendChild(element);
            clearOld()
        }
        function clearOld() {
            var div = document.getElementById('console');
            if (!div) return;
            while (div.childElementCount > 12) {
                div.removeChild(div.firstChild);
            }
        }
    </script>
    <script>
    // Polyfill for creating CustomEvents on IE9/10/11

    // code pulled from:
    // https://github.com/d4tocchini/customevent-polyfill
    // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent#Polyfill

    try {
        var ce = new window.CustomEvent('test');
        ce.preventDefault();
        if (ce.defaultPrevented !== true) {
            // IE has problems with .preventDefault() on custom events
            // http://stackoverflow.com/questions/23349191
            throw new Error('Could not prevent default');
        }
    } catch(e) {
    var CustomEvent = function(event, params) {
        var evt, origPrevent;
        params = params || {
        bubbles: false,
        cancelable: false,
        detail: undefined
        };

        evt = document.createEvent("CustomEvent");
        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);
        origPrevent = evt.preventDefault;
        evt.preventDefault = function () {
        origPrevent.call(this);
        try {
            Object.defineProperty(this, 'defaultPrevented', {
            get: function () {
                return true;
            }
            });
        } catch(e) {
            this.defaultPrevented = true;
        }
        };
        return evt;
    };

    CustomEvent.prototype = window.Event.prototype;
    window.CustomEvent = CustomEvent; // expose definition to window
    }
</script>
</body>

</html>